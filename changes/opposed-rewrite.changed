Complete rewrite of `/met opposed` to be more powerful and resilient